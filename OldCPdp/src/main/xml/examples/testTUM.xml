<?xml version='1.0' standalone='yes' ?>
<policySet xmlns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage" 
           xmlns:tns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
           xmlns:a="http://www.iese.fhg.de/pef/1.0/action" 
           xmlns:e="http://www.iese.fhg.de/pef/1.0/event" 
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <actionDescriptions>
    <actionDescription name="event.homeapp.controller.backend" />
  </actionDescriptions>

  <preventiveMechanism name="testTUM">
    <description>...</description>
    <timestep amount="10" unit="SECONDS" />
    <trigger action="testEvent" isTry="true">
<!--      <paramMatch name="val1" value="value1" type="dataUsage" />
      <paramMatch name="val2" value="value2" type="dataUsage" />-->
    </trigger>
    <condition>
      <or>
	    	<not>
	    	 <stateBasedFormula operator="isNotIn" param1="src_java.io.FileInputStream.read()I" param2="val2" param3="val3" />
	    	</not>
	      <!-- operator isNotIn and operator isOnlyIn -> par1=data par2=string -->
	      <!-- operator isCombinedWith -> par1=data par2=data -->
	      <!-- operator atMostInSet and atMostInEach -> par1=data par2=string par3=int -->
        <and>
					<eval type="XPATH"> an arbitrary xpath formula </eval>
					<eval type="MATH"> 3+2=5 </eval>
        </and>
      </or>      
    </condition>
    <authorizationAction name="default" start="true" fallback="fallback">
      <allow>
        <executeSyncAction name="deployPolicy">
          <parameter name="file" value="abc.xml"/>
        </executeSyncAction>
      </allow>
    </authorizationAction>
    <authorizationAction name="fallback">
      <allow>
        <modify>
          <parameter name="path" value="dev/null"/>
        </modify>
      </allow>
    </authorizationAction>
	  <executeAsyncAction name="log" processor="pep">
	    <parameter name="file" value="abc.xml"/>
	  </executeAsyncAction>
    <executeAsyncAction name="log2" processor="pxp">
      <parameter name="file" value="abc.xml"/>
    </executeAsyncAction>	  
  </preventiveMechanism>


  <preventiveMechanism name="WritefileTest">
    <description>...</description>
    <timestep amount="10" unit="SECONDS" />
    <trigger action="WriteFile" isTry="true">
      <paramMatch name="InFileName" value="C:\Users\user\Desktop\copyAndRun\file3.txt"/>
    </trigger>
    <condition>
      <true/>
    </condition>
    <authorizationAction name="default" start="true">
      <inhibit/>
    </authorizationAction>
  </preventiveMechanism>

  <preventiveMechanism name="createFileTest">
    <description>...</description>
    <timestep amount="10" unit="SECONDS" />
    <trigger action="CreateFileW" isTry="true">
      <paramMatch name="InFileName" value="C:\Users\user\Desktop\copyAndRun\file3.txt"/>
    </trigger>
    <condition>
      <true/>
    </condition>
    <authorizationAction name="default" start="true">
      <inhibit/>
    </authorizationAction>
  </preventiveMechanism>

</policySet>
