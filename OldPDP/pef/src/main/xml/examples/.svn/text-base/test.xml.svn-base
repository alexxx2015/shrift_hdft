<?xml version='1.0' standalone='yes' ?>
<policySet xmlns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage" 
           xmlns:tns="http://www.iese.fhg.de/pef/1.0/enforcementLanguage"
           xmlns:a="http://www.iese.fhg.de/pef/1.0/action" 
           xmlns:e="http://www.iese.fhg.de/pef/1.0/event" 
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <interfaceDescriptions>
    <!-- <pep name="pep0" type="native"/>-->
    <!-- <pep name="pep1" type="jni">
      <parameter name="className" value="de/fraunhofer/iese/pef/pdp/PolicyDecisionPoint" />
      <parameter name="methodName" value="handlePEPsubscribe" />
      <parameter name="methodSignature" value="(Ljava/lang/String;I)I" />
    </pep> -->
    <!-- <pep name="pep2" type="socket">
      <parameter name="type" value="TCP" />
      <parameter name="host" value="localhost" />
      <parameter name="port" value="10001" />
    </pep> -->
    
    <!-- <pxp name="pxp0" type="native"/>
    <pxp name="pxp1" type="jni">
      <parameter name="className" value="de/fraunhofer/iese/pef/pdp/PolicyDecisionPoint" />
      <parameter name="methodName" value="handlePXPexecute" />
      <parameter name="methodSignature" value="(Ljava/lang/String;Ljava/util/ArrayList;)I" />
    </pxp>-->
    <!-- <pxp name="pxp2" type="socket">
      <parameter name="type" value="TCP" />
      <parameter name="host" value="localhost" />
      <parameter name="port" value="10001" />
    </pxp>-->
  </interfaceDescriptions>

  <actionDescriptions>
    <actionDescription name="action1" />
    <actionDescription name="action2" />
    <actionDescription name="action3" />
  </actionDescriptions>

    <detectiveMechanism name="testDetective2">
    <description>...</description>
    <timestep amount="3" unit="SECONDS" />
    <condition><true /></condition>
    <executeAction name="notify" >
      <parameter name="msg" value="hallo" />
      <parameter name="severity" value="high" />
      <parameter name="testEval" value="string(//event/parameter[@name='val2']/@value)" type="xpath" />
    </executeAction>
  </detectiveMechanism>  
  
  <preventiveMechanism name="test">
    <description>...</description>
    <timestep amount="3" unit="SECONDS" />
    <trigger action="action2" isTry="true">
      <paramMatch name="val2" value="value2" />
    </trigger>
    <condition><true /></condition>
    <authorizationAction name="default">
      <allow>
        <executeAction name="notify" >
          <parameter name="msg" value="hallo" />
          <parameter name="severity" value="high" />
          <parameter name="testEval" value="string(//event/parameter[@name='val2']/@value)" type="xpath" />
        </executeAction>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
  
  <detectiveMechanism name="testDetective">
    <description>...</description>
    <timestep amount="3" unit="SECONDS" />
    <condition><true /></condition>
    <executeAction name="notify" >
      <parameter name="msg" value="hallo" />
      <parameter name="severity" value="high" />
      <parameter name="testEval" value="string(//event/parameter[@name='val2']/@value)" type="xpath" />
    </executeAction>
  </detectiveMechanism>
  
    <preventiveMechanism name="test2">
    <description>...</description>
    <timestep amount="3" unit="SECONDS" />
    <trigger action="action2" isTry="true">
      <paramMatch name="val2" value="value2" />
    </trigger>
    <condition><true /></condition>
    <authorizationAction name="default">
      <allow>
        <executeAction name="notify" >
          <parameter name="msg" value="hallo" />
          <parameter name="severity" value="high" />
          <parameter name="testEval" value="string(//event/parameter[@name='val2']/@value)" type="xpath" />
        </executeAction>
      </allow>
    </authorizationAction>
  </preventiveMechanism>
  
</policySet>
